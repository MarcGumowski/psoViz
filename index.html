<!DOCTYPE html>
<html>

<head>
  <title> psoViz </title>
  <link rel="stylesheet" href="src/styles.css" type="text/css">
</head>

  <body>
    <center>
      <h1>Particle Swarm Optimization</h1>
      <h2>Visualization</h2></center>
  
    <!-- Page -->
    <div class="wrapper row">
      <div id="container" class="clear">

        <section id="graph" class="clear">
          <figure><div id="psoViz"></div>
            <figcaption>
              <h2>Parameters</h2>
                <h3>Expression</h3>
                f(x,y) = 
                <h3>Search space</h3>
                x &#8712; [], y &#8712; []
                <h3>Optimization parameters</h3> 
                 Number of iterations <br>
                 &omega; <br>
                 &phi;<sub>p</sub> <br>
                 &phi;<sub>g</sub> 
                <h3>Simulation</h3>
                 <button class="myButton" type="button" id="refresh">Refresh</button> 
                 <button class="myButton" type="button" id="start">Start</button>
                 <h3>Results</h3>
                   <span id = "psoVizResultsX"></span><br>
                   <span id = "psoVizResultsY"></span><br>
                   <span id = "psoVizResultsF"></span>
            </figcaption>
          </figure>
        </section>
        
        <div id="content">
          <section class="clear">
            
            <article class="contentBox">
              <h3>Note</h3>
              <p><font color="#3299BB">&omega;</font>, <font color="#3299BB">&phi;<sub>p</sub></font> and <font color="#3299BB">&phi;<sub>g</sub></font> control the behaviour and efficacy of the PSO method. <br>
              They can have a large impact on the optimization performance. Choose them precautiously.</p>
             <p>To update the expression, please use basic javascript language. <br>
              For instance, <font color="#3299BB">x&sup2;</font> is written <font color="#3299BB">Math</font>.<font color="#FF9900">pow</font>(x, 2), <font color="#3299BB">&#8730;<span style="text-decoration: overline">x</span></font> is written <font color="#3299BB">Math</font>.<font color="#FF9900">sqrt</font>(x), etc.</p> 
            </article>
            
          </section> 
        </div>
        
      </div>
    </div>
    
  <!-- JS -->
  <script src="src/d3v4/d3.min.js"></script>
  <script src="src//d3-scale-chromatic.min.js"></script>
  <script src="src/d3-contour.min.js"></script>
  <script src="src/psoViz.js"></script>
  
  <script>
  
    // Define expression
    function expr(x, y) {
      return (1 + Math.pow(x + y + 1, 2) * (19 - 14 * x + 3 * x * x - 14 * y + 6 * x * x + 3 * y * y))
          * (30 + Math.pow(2 * x - 3 * y, 2) * (18 - 32 * x + 12 * x * x + 48 * y - 36 * x * y + 27 * y * y));
    }

    /*function expr(x, y) { 
        return Math.pow(x + 2 * y -7, 2) + Math.pow(2 * x + y - 5, 2);
    }*/
    
    // Define options
    var options = {
      grid: { xMin: -2, xMax: 2, yMin: -2, yMax: 1 },
      iteration: 10,
      radius: 4,
    };
    
    // Call psoViz function
    psoViz("#psoViz", expr, options);
    
    // Add button that call psoViz to refresh
    d3.select('#refresh')
      .on('click', function(d) {
	      d3.select('#psoViz').select("svg").remove();
	      d3.select('#psoViz').select(".tooltip").remove();
	      d3.select('#psoViz').select(".tooltipBest").remove();
        psoViz("#psoViz", expr, options);
      });
  </script>

  </body>
  
</html>
